<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Use GitHub Pages and kscript to host and validate static JSON API</title>
	
	<meta name="author" content="Daniele Campogiani">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/blog/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/blog/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/blog/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/blog/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/blog/feed.xml">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-113556465-1', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', false);
    </script>
    <!-- End Google Analytics -->
    </head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/dcampogiani">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/dcampogiani">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:daniele.campogiani@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/blog/">
				<img src="/blog/assets/avatar.jpg" class="img-circle" />
				Daniele Campogiani
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/blog/">Blog</a></li>
				<li><a href="http://dcampogiani.github.io/">Website</a></li>
				<li><a href="/blog/categories">Categories</a></li>
				<li><a href="/blog/tags">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/blog/"><i class="fa fa-book"></i>Blog</a></li>
			<li><a href="http://dcampogiani.github.io/"><i class="fa fa-home"></i>Website</a></li>
			<li><a href="/blog/categories"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/blog/tags"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<! -- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/blog/">
		<img src="/blog/assets/avatar.jpg" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/blog/">Daniele Campogiani</a>
    </h3>
</header>


<div id="bio" class="text-center">
	Software Engineer
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		<li>
			<a class="btn btn-default btn-sm" href="http://dcampogiani.github.io/">
				<i class="fa fa-home fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/dcampogiani">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/dcampogiani">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:daniele.campogiani@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/pub/danielecampogiani">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/blog/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<! -- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Use GitHub Pages and kscript to host and validate static JSON API </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   March 
	   12th,
	   
	   2020
	 </span>
	  <div class="article_body">
	  <p>In Bologna, we have a <a href="http://bit.ly/32VyE3w">community about Functional Programming</a>, and lately, I was looking for a quick and easy way to host all the data of the talks.</p>

<p>In this post, we will see how we can use GitHub pages to host the JSON files, and kscript to validate the data before “deploy”.</p>

<h3 id="github-pages">Github Pages</h3>

<p>GitHub Pages is a quick way to host data for free so why don’t we use it also to store some static JSON and use it as API in an app?</p>

<p>To use it we just need a Github repo and enable the feature as explained in <a href="https://pages.github.com/">this guide</a></p>

<p>Once done we can push the JSON file and it will be hosted for us for free.</p>

<p>Example:</p>

<ul>
  <li>
    <p>file in a git repo: <a href="https://github.com/fp-in-bo/data/blob/master/events/all.json">https://github.com/fp-in-bo/data/blob/master/events/all.json</a></p>
  </li>
  <li>
    <p>same file hosted by GitHub Pages: <a href="https://fp-in-bo.github.io/data/events/all.json">https://fp-in-bo.github.io/data/events/all.json</a></p>
  </li>
</ul>

<p><br /></p>

<h4 id="kscript">kscript</h4>

<p>Kscript will bring enhanced scripting support for Kotlin on *nix-based systems, so we can use it fo validate our data before deploying it.</p>

<p>After a quick <a href="https://github.com/holgerbrandl/kscript#installation">installation</a> we can start to write our validation script.</p>

<p>To write our first kscript here’s what we need to do:</p>

<ul>
  <li>
    <p>create empty file</p>

    <p><code>touch script.kts</code></p>
  </li>
  <li>
    <p>make a script automatically install kscript and its dependencies on the first run if necessary</p>

    <p><code>kscript --add-bootstrap-header script.kts</code></p>
  </li>
  <li>
    <p>open the script with some IDE / text editor (I’ll use IntelliJ)</p>

    <p><code>kscript --idea script.kts</code></p>
  </li>
  <li>
    <p>write our logic</p>
  </li>
</ul>

<p>Kscript allows us to use dependencies, so we’re going to use Jackson in this example.
To add the dependency in our script we just need to declare it directly inside the script like following:</p>

<p><code>//DEPS com.fasterxml.jackson.module:jackson-module-kotlin:2.10.1</code></p>

<p>In this example we are going to read a file from arguments, then parse it using Jackson, here is the full <a href="https://github.com/fp-in-bo/data/blob/master/scripts/validateJson.kts">script</a>:</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/f0d2f182f0397c779d23c28cf9ef0c97.js"> </script>

<p>Another feature of kscript is to create standalone binaries, let’s do it because we’re gonna use it in our continuous integration:</p>

<p>kscript –package script.kts</p>

<p><br /></p>

<h4 id="continuous-integration">Continuous Integration</h4>

<p>Our desired flow to publish a new talk to the repo is:</p>

<ul>
  <li>open a new branch</li>
  <li>add a talk into the JSON</li>
  <li>open a PR</li>
  <li>waiting for checks in Continuous Integration</li>
  <li>merge the PR</li>
</ul>

<p>This way once the PR will be merged to master, the new talk will be available in our API.
In this repository, I’m using Travis for CI, and all we need is to invoke our script passing the right file</p>

<p><code>scripts/validateJson events/all.json</code></p>

<p><br />
<br /></p>

<p>That’s all.
I find this approach and the mix of these two tools pragmatic and I suggest this approach if you need to host some data that will not change very frequently. <a href="https://github.com/fp-in-bo/data">You can find here the repo</a>.</p>

<p>Thanks <a href="https://twitter.com/FChiusolo/">@FChiusolo</a> for the fish.</p>


	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="https://danielecampogiani.com/blog/categories#github-ref">
					github <span>(1)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#github-pages-ref">
					github-pages <span>(1)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#kscript-ref">
					kscript <span>(1)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#json-ref">
					json <span>(1)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#api-ref">
					api <span>(1)</span>
					
				</a></li>
			
		  
		</ul>
		  

		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Use GitHub Pages and kscript to host and validate static JSON API&via=dcampogiani"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="/blog/assets/avatar.jpg" class="img-rounded author-image" />
        <h4 class="section-title author-name">Daniele Campogiani</h4>
        <p class="author-bio">Software Engineer</p>
      </section>
    </div>

	<hr>
	
	    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'danielecampogiani'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="https://danielecampogiani.com/blog/2018/02/android-functional-validation-4-validated/" title="Android Functional Validation 4 - Validated">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="https://danielecampogiani.com/blog/2020/08/card-scanner-on-android-using-camerax-and-mlkit/" title="Card Scanner on Android using CameraX and MLKit">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



		<footer>
			<hr/>
			<p>
				&copy; 2020 Daniele Campogiani with Jekyll. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/blog/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/blog/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/blog/assets/js/app.js"></script>
</body>
</html>

