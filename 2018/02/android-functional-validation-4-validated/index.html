<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Android Functional Validation 4 - Validated</title>
	
	<meta name="author" content="Daniele Campogiani">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/blog/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/blog/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/blog/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/blog/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/blog/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/dcampogiani">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/dcampogiani">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:daniele.campogiani@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/blog/">
				<img src="/blog/assets/avatar.jpg" class="img-circle" />
				Daniele Campogiani
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/blog/">Blog</a></li>
				<li><a href="http://dcampogiani.github.io/">Website</a></li>
				<li><a href="/blog/categories">Categories</a></li>
				<li><a href="/blog/tags">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/blog/"><i class="fa fa-book"></i>Blog</a></li>
			<li><a href="http://dcampogiani.github.io/"><i class="fa fa-home"></i>Website</a></li>
			<li><a href="/blog/categories"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/blog/tags"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<! -- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/blog/">
		<img src="/blog/assets/avatar.jpg" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/blog/">Daniele Campogiani</a>
    </h3>
</header>


<div id="bio" class="text-center">
	Software Engineer
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		<li>
			<a class="btn btn-default btn-sm" href="http://dcampogiani.github.io/">
				<i class="fa fa-home fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/dcampogiani">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/dcampogiani">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:daniele.campogiani@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/pub/danielecampogiani">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/blog/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<! -- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Android Functional Validation 4 - Validated </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   February 
	   10th,
	   
	   2018
	 </span>
	  <div class="article_body">
	  <p>This is the last post of the <a href="/blog/2018/02/android-functional-validation-1-intro/">Functional Validation</a> serie and we are going to use Validated, our last data type.</p>

<p><a href="http://arrow-kt.io/docs/datatypes/validated/">Validated</a> is like Either with some additional power, and using it we can finally aggregate all errors and give proper feedback to our users.</p>

<h3 id="lets-use-validated">Let’s use Validated</h3>

<p>Like Either, Validated will contain two possible values, one when the data is invalid, and one when the data is valid. But this time we are going to use different types.</p>

<p>We will use</p>
<ul>
  <li>
    <p><code>Validated&lt;Nel&lt;ValidationError&gt;, String&gt;</code> for email</p>
  </li>
  <li>
    <p><code>Validated&lt;Nel&lt;ValidationError&gt;, String&gt;</code> for phone numbers</p>
  </li>
  <li>
    <p><code>Validated&lt;Nel&lt;ValidationError&gt;, Data&gt;</code> for the whole form</p>
  </li>
</ul>

<p>ValidationError is a sealed class used to define all possible errors:</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/24bc1899fe7c16888f18aa9736a3f249.js"> </script>

<p>And Nel is a <a href="http://arrow-kt.io/docs/datatypes/nonemptylist/">NotEmptyList</a> that will aggregate errors.</p>

<p>Validated has two possible values: Valid and Invalid and we will use the as following:</p>

<p><br /></p>

<h4 id="mail">Mail</h4>

<div style="text-align:center"><img src="/blog/assets/Validated1.png" />
</div>

<p><br /></p>

<div style="text-align:center"><img src="/blog/assets/Validated2.png" />
</div>

<p><br /></p>

<h4 id="phone-number">Phone Number</h4>

<div style="text-align:center"><img src="/blog/assets/Validated3.png" />
</div>

<p><br /></p>

<div style="text-align:center"><img src="/blog/assets/Validated4.png" />
</div>

<p><br /></p>

<p>Once again we will use kotlin extension methods invoking <a href="/blog/2018/02/android-functional-validation-1-intro/">validMail and validNumber functions we have discussed in the first post</a> to build our instances.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/4f4221b3f149448feddb47234f0edbf2.js"> </script>

<p>if the validation function returns true we will wrap the value using the .valid() method, otherwise we will create a Nel with the correct error and wrap it using the .invalid() method.</p>

<h3 id="map-them">Map them</h3>

<p>By now we are experts of map, let’s use it</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/b1a3213da53deee236b7d058caae5235.js"> </script>

<p>Using Validated our map finally has the desired behaviour and we get all input errors in the list:</p>

<p><br /></p>

<div style="text-align:center"><img src="/blog/assets/Validated5.png" />
</div>

<p><br /></p>

<h3 id="android-ui">Android UI</h3>

<p>In our ViewModel we will use the previously discussed code to update a <code>&lt;Validated&lt;Nel&lt;ValidationError&gt;, Data&gt;&gt;</code></p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/54610009571b9c6628774d35818842ec.js"> </script>

<p>In the activity we retrieve the viewModel, register click listener and observe the result of the validation. Once we get the result we clear previous errors and then fold it.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/21671e076f123f981053b0034721d469.js"> </script>

<h4 id="fold">Fold</h4>

<p>Once again we are using method reference with the following methods:</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/0c04304d56f6b27252296297a3490096.js"> </script>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/f390917f58a77a145d4cadede8c7ec25.js"> </script>

<p>In the invalid path we using kotlin <code>when</code> to find the correct error message and TextInputLayout to notify the user, while in the valid path we just show data to user.</p>

<p><a href="https://github.com/dcampogiani/AndroidFunctionalValidation/pull/4">You can find here the implementation using Either</a></p>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="https://danielecampogiani.com/blog/categories#android-ref">
					android <span>(5)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#functional-ref">
					functional <span>(4)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#validation-ref">
					validation <span>(4)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#kotlin-ref">
					kotlin <span>(4)</span>
					,
				</a></li>
			 
				<li><a href="https://danielecampogiani.com/blog/categories#arrow-ref">
					arrow <span>(4)</span>
					
				</a></li>
			
		  
		</ul>
		  

		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Android Functional Validation 4 - Validated&via=dcampogiani"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="/blog/assets/avatar.jpg" class="img-rounded author-image" />
        <h4 class="section-title author-name">Daniele Campogiani</h4>
        <p class="author-bio">Software Engineer</p>
      </section>
    </div>

	<hr>
	
	    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'danielecampogiani'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="https://danielecampogiani.com/blog/2018/02/android-functional-validation-3-either/" title="Android Functional Validation 3 - Either">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="https://danielecampogiani.com/blog/2020/03/use-github-pages-and-kscript-to-host-and-validate-static-json-api/" title="Use GitHub Pages and kscript to host and validate static JSON API">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



		<footer>
			<hr/>
			<p>
				&copy; 2022 Daniele Campogiani with Jekyll. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/blog/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/blog/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/blog/assets/js/app.js"></script>
</body>
</html>

